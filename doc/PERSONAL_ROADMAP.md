# æ˜Ÿæ¢ç»ˆç«¯ - ä¸ªäººä½¿ç”¨ç‰ˆåŠŸèƒ½è§„åˆ’è·¯çº¿å›¾

> **å®šä½è¯´æ˜**ï¼šæœ¬é¡¹ç›®å®šä½ä¸ºä¸ªäººä½¿ç”¨çš„è¿œç¨‹ç»ˆç«¯ç®¡ç†å·¥å…·ï¼Œä¸æ¶‰åŠå¤šç”¨æˆ·ã€æƒé™ç®¡ç†ã€å›¢é˜Ÿåä½œç­‰åŠŸèƒ½ï¼Œä¸“æ³¨äºæå‡ä¸ªäººè¿ç»´æ•ˆç‡ä¸ä½¿ç”¨ä½“éªŒã€‚

---

## ğŸ“‹ ç›®å½•

- [è®¾è®¡åŸåˆ™](#è®¾è®¡åŸåˆ™)
- [Phase 6: ä¸ªäººå·¥ä½œæµå¢å¼º](#phase-6-ä¸ªäººå·¥ä½œæµå¢å¼º)
- [Phase 7: æ™ºèƒ½åŒ–ä¸è‡ªåŠ¨åŒ–](#phase-7-æ™ºèƒ½åŒ–ä¸è‡ªåŠ¨åŒ–)
- [Phase 8: æ•°æ®æ´å¯Ÿä¸å¯è§†åŒ–](#phase-8-æ•°æ®æ´å¯Ÿä¸å¯è§†åŒ–)
- [Phase 9: è·¨å¹³å°ä¸åŒæ­¥](#phase-9-è·¨å¹³å°ä¸åŒæ­¥)
- [Phase 10: é«˜çº§ç»ˆç«¯èƒ½åŠ›](#phase-10-é«˜çº§ç»ˆç«¯èƒ½åŠ›)
- [Phase 11: ä¸ªäººçŸ¥è¯†åº“](#phase-11-ä¸ªäººçŸ¥è¯†åº“)
- [é•¿æœŸæ„¿æ™¯åŠŸèƒ½](#é•¿æœŸæ„¿æ™¯åŠŸèƒ½)
- [å®æ–½ä¼˜å…ˆçº§çŸ©é˜µ](#å®æ–½ä¼˜å…ˆçº§çŸ©é˜µ)
- [æŠ€æœ¯æ¶æ„æ¼”è¿›å»ºè®®](#æŠ€æœ¯æ¶æ„æ¼”è¿›å»ºè®®)

---

## ğŸ¯ è®¾è®¡åŸåˆ™

### æ ¸å¿ƒç†å¿µ

1. **ä¸ªäººä¼˜å…ˆ**ï¼šæ‰€æœ‰åŠŸèƒ½å›´ç»•å•ç”¨æˆ·ä½“éªŒè®¾è®¡ï¼Œæ— éœ€è€ƒè™‘æƒé™åˆ†çº§
2. **æ•ˆç‡è‡³ä¸Š**ï¼šå‡å°‘é‡å¤æ“ä½œï¼Œå¿«æ·é”®ä¼˜å…ˆï¼Œè‡ªåŠ¨åŒ–æµç¨‹
3. **æ•°æ®æœ¬åœ°**ï¼šæ•æ„Ÿæ•°æ®æœ¬åœ°å­˜å‚¨ï¼Œäº‘ç«¯åŠŸèƒ½å¯é€‰
4. **æ¸è¿›å¢å¼º**ï¼šåŠŸèƒ½åˆ†é˜¶æ®µå®æ–½ï¼Œä¿æŒç³»ç»Ÿç¨³å®šæ€§
5. **è½»é‡çµæ´»**ï¼šé¿å…è¿‡åº¦è®¾è®¡ï¼Œä¿æŒéƒ¨ç½²ç®€å•

### æŠ€æœ¯çº¦æŸ

- SQLite ä½œä¸ºå”¯ä¸€æ•°æ®åº“ï¼Œé¿å…å¼•å…¥å¤æ‚å­˜å‚¨
- åç«¯ä¿æŒå•è¿›ç¨‹æ¶æ„ï¼Œé€šè¿‡ WebSocket é•¿è¿æ¥å®ç°å®æ—¶æ€§
- å‰ç«¯ç»„ä»¶åŒ–å¼€å‘ï¼ŒæŒ‰éœ€åŠ è½½å‡å°‘åˆå§‹ä½“ç§¯
- Docker éƒ¨ç½²ä¸ºä¸»ï¼Œæ”¯æŒæœ¬åœ°å¼€å‘ç¯å¢ƒ

---

## Phase 6: ä¸ªäººå·¥ä½œæµå¢å¼º

### 6.1 å¿«é€Ÿå‘½ä»¤æ¨¡æ¿ç³»ç»Ÿ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- æ”¯æŒå‚æ•°åŒ–å‘½ä»¤æ¨¡æ¿ï¼ˆå¦‚ `docker logs -f {{container}}`ï¼‰
- æ¨¡æ¿åˆ†ç»„ç®¡ç†ï¼ˆç³»ç»Ÿç»´æŠ¤ã€å¼€å‘è°ƒè¯•ã€æ•°æ®å¤‡ä»½ç­‰ï¼‰
- æ¨¡æ¿å˜é‡æç¤ºä¸å†å²è®°å½•
- æ”¯æŒæ¨¡æ¿é“¾ï¼ˆå¤šæ¡å‘½ä»¤åºåˆ—æ‰§è¡Œï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE command_templates (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  description TEXT,
  template TEXT NOT NULL,          -- å‘½ä»¤æ¨¡æ¿ï¼Œæ”¯æŒ {{var}} å ä½ç¬¦
  category TEXT DEFAULT 'general', -- åˆ†ç»„
  variables TEXT,                  -- JSON æ•°ç»„ï¼Œå­˜å‚¨å˜é‡å®šä¹‰
  is_chain BOOLEAN DEFAULT 0,      -- æ˜¯å¦ä¸ºå‘½ä»¤é“¾
  chain_delay INTEGER DEFAULT 1000,-- å‘½ä»¤é“¾å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
  order_index INTEGER DEFAULT 0,   -- æ’åº
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE template_variable_history (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  template_id INTEGER NOT NULL,
  variable_name TEXT NOT NULL,
  variable_value TEXT NOT NULL,
  used_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (template_id) REFERENCES command_templates(id) ON DELETE CASCADE
);

CREATE INDEX idx_template_category ON command_templates(category);
CREATE INDEX idx_variable_history ON template_variable_history(template_id, variable_name);
```

#### åç«¯æ¨¡å— (`packages/backend/src/command-templates/`)

```
command-templates/
â”œâ”€â”€ routes.ts           # RESTful API è·¯ç”±
â”œâ”€â”€ controller.ts       # è¯·æ±‚å¤„ç†
â”œâ”€â”€ service.ts          # ä¸šåŠ¡é€»è¾‘ï¼šæ¨¡æ¿è§£æã€å˜é‡æ›¿æ¢
â”œâ”€â”€ repository.ts       # æ•°æ®è®¿é—®
â””â”€â”€ types.ts           # ç±»å‹å®šä¹‰
```

#### å…³é”®æ¥å£

- `GET /api/v1/command-templates` - è·å–æ‰€æœ‰æ¨¡æ¿ï¼ˆæ”¯æŒåˆ†ç±»ç­›é€‰ï¼‰
- `POST /api/v1/command-templates` - åˆ›å»ºæ¨¡æ¿
- `PUT /api/v1/command-templates/:id` - æ›´æ–°æ¨¡æ¿
- `DELETE /api/v1/command-templates/:id` - åˆ é™¤æ¨¡æ¿
- `POST /api/v1/command-templates/:id/render` - æ¸²æŸ“æ¨¡æ¿ï¼ˆæ›¿æ¢å˜é‡ï¼‰
- `GET /api/v1/command-templates/:id/variable-history/:name` - è·å–å˜é‡å†å²è®°å½•

#### å‰ç«¯ç»„ä»¶ (`packages/frontend/src/features/command-templates/`)

```
command-templates/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ TemplateList.vue          # æ¨¡æ¿åˆ—è¡¨ï¼ˆæ”¯æŒæ‹–æ‹½æ’åºï¼‰
â”‚   â”œâ”€â”€ TemplateEditor.vue        # æ¨¡æ¿ç¼–è¾‘å™¨ï¼ˆMonaco Editorï¼‰
â”‚   â”œâ”€â”€ VariableInput.vue         # å˜é‡è¾“å…¥å¼¹çª—ï¼ˆæ”¯æŒå†å²è®°å½•è‡ªåŠ¨å®Œæˆï¼‰
â”‚   â””â”€â”€ ChainExecutor.vue         # å‘½ä»¤é“¾æ‰§è¡Œå™¨ï¼ˆæ˜¾ç¤ºè¿›åº¦ï¼‰
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ template.store.ts         # Pinia Store
â””â”€â”€ composables/
    â”œâ”€â”€ useTemplateParser.ts      # æ¨¡æ¿è§£æé€»è¾‘
    â””â”€â”€ useTemplateExecution.ts   # æ‰§è¡Œé€»è¾‘
```

**é¢„è®¡å·¥ä½œé‡**ï¼š5-7 å¤©

---

### 6.2 å·¥ä½œåŒºå¿«ç…§ä¸åœºæ™¯åˆ‡æ¢ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- ä¿å­˜å½“å‰å·¥ä½œåŒºçŠ¶æ€ï¼ˆæ‰€æœ‰æ‰“å¼€çš„è¿æ¥ã€æ ‡ç­¾é¡µã€å¸ƒå±€ï¼‰
- ä¸€é”®æ¢å¤å·¥ä½œåŒºå¿«ç…§
- åœºæ™¯é¢„è®¾ï¼ˆå¦‚"å‰ç«¯å¼€å‘"ã€"æœåŠ¡å™¨å·¡æ£€"ã€"æ•°æ®åº“ç»´æŠ¤"ï¼‰
- è‡ªåŠ¨å¿«ç…§åŠŸèƒ½ï¼ˆæ¯æ—¥è‡ªåŠ¨ä¿å­˜ï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE workspace_snapshots (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  description TEXT,
  snapshot_data TEXT NOT NULL,    -- JSON æ ¼å¼å­˜å‚¨å®Œæ•´å·¥ä½œåŒºçŠ¶æ€
  is_auto BOOLEAN DEFAULT 0,      -- æ˜¯å¦ä¸ºè‡ªåŠ¨å¿«ç…§
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_snapshot_auto ON workspace_snapshots(is_auto, created_at);
```

#### snapshot_data ç»“æ„ç¤ºä¾‹

```json
{
  "layout": "three-column",
  "connections": [
    {
      "id": 123,
      "protocol": "ssh",
      "tabs": [
        { "type": "terminal", "title": "web-server", "suspended": false },
        { "type": "sftp", "path": "/var/www", "filters": ["*.log"] }
      ]
    }
  ],
  "appearance": {
    "theme": "dracula",
    "fontSize": 14
  },
  "metadata": {
    "totalConnections": 3,
    "openTabs": 8
  }
}
```

#### åç«¯æ¨¡å— (`packages/backend/src/workspace/`)

```
workspace/
â”œâ”€â”€ routes.ts
â”œâ”€â”€ controller.ts
â”œâ”€â”€ service.ts          # å¿«ç…§åˆ›å»ºã€æ¢å¤é€»è¾‘
â”œâ”€â”€ repository.ts
â””â”€â”€ scheduler.ts        # å®šæ—¶ä»»åŠ¡ï¼šè‡ªåŠ¨å¿«ç…§ï¼ˆä½¿ç”¨ node-cronï¼‰
```

#### å‰ç«¯ç»„ä»¶ (`packages/frontend/src/features/workspace/`)

```
workspace/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ SnapshotManager.vue       # å¿«ç…§ç®¡ç†é¢æ¿
â”‚   â”œâ”€â”€ SnapshotCard.vue          # å¿«ç…§é¢„è§ˆå¡ç‰‡
â”‚   â””â”€â”€ RestorePreview.vue        # æ¢å¤é¢„è§ˆå¯¹è¯æ¡†
â””â”€â”€ composables/
    â””â”€â”€ useWorkspaceRestore.ts    # å·¥ä½œåŒºæ¢å¤é€»è¾‘
```

**å…³é”®äº¤äº’**ï¼š

1. ç”¨æˆ·ç‚¹å‡»"ä¿å­˜å·¥ä½œåŒº"ï¼Œè§¦å‘å‰ç«¯æ”¶é›†å½“å‰çŠ¶æ€
2. å‰ç«¯å‘é€å¿«ç…§æ•°æ®åˆ°åç«¯å­˜å‚¨
3. æ¢å¤æ—¶ï¼Œå‰ç«¯æŒ‰å¿«ç…§æ•°æ®ä¾æ¬¡é‡å»ºè¿æ¥å’Œæ ‡ç­¾é¡µ

**é¢„è®¡å·¥ä½œé‡**ï¼š4-6 å¤©

---

### 6.3 è¿æ¥åˆ†ç»„ä¸æ ‡ç­¾ç³»ç»Ÿ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- ä¸º SSH è¿æ¥æ·»åŠ å¤šæ ‡ç­¾ï¼ˆç”Ÿäº§ã€æµ‹è¯•ã€ä¸ªäººç­‰ï¼‰
- æŒ‰æ ‡ç­¾ç­›é€‰è¿æ¥
- é¢œè‰²æ ‡è®°ï¼ˆä¸ºä¸åŒæ ‡ç­¾è®¾ç½®é¢œè‰²ï¼‰
- å¿«é€Ÿåˆ‡æ¢æ ‡ç­¾ç»„

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE connection_tags (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL UNIQUE,
  color TEXT DEFAULT '#3B82F6',   -- æ ‡ç­¾é¢œè‰²ï¼ˆHexï¼‰
  icon TEXT,                       -- å¯é€‰å›¾æ ‡åç§°
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE connection_tag_mapping (
  connection_id INTEGER NOT NULL,
  tag_id INTEGER NOT NULL,
  PRIMARY KEY (connection_id, tag_id),
  FOREIGN KEY (connection_id) REFERENCES connections(id) ON DELETE CASCADE,
  FOREIGN KEY (tag_id) REFERENCES connection_tags(id) ON DELETE CASCADE
);
```

#### åç«¯æ¥å£

- `GET /api/v1/tags` - è·å–æ‰€æœ‰æ ‡ç­¾
- `POST /api/v1/tags` - åˆ›å»ºæ ‡ç­¾
- `POST /api/v1/connections/:id/tags` - ä¸ºè¿æ¥æ·»åŠ æ ‡ç­¾
- `GET /api/v1/connections?tags=prod,dev` - æŒ‰æ ‡ç­¾ç­›é€‰è¿æ¥

#### å‰ç«¯å®ç°

- åœ¨è¿æ¥åˆ—è¡¨ä¸­æ˜¾ç¤ºæ ‡ç­¾å¾½ç« 
- æ ‡ç­¾ç®¡ç†é¢æ¿ï¼ˆæ‹–æ‹½æ’åºã€é¢œè‰²é€‰æ‹©å™¨ï¼‰
- ç­›é€‰å™¨ç»„ä»¶ï¼ˆæ”¯æŒå¤šé€‰æ ‡ç­¾ï¼‰

**é¢„è®¡å·¥ä½œé‡**ï¼š2-3 å¤©

---

### 6.4 å‘½ä»¤ä¹¦ç­¾ä¸æ”¶è—å¤¹ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- ä¸ºå¸¸ç”¨å‘½ä»¤æ·»åŠ ä¹¦ç­¾
- æ”¯æŒå¿«æ·é”®ç›´æ¥æ‰§è¡Œæ”¶è—å‘½ä»¤
- ä¹¦ç­¾åˆ†ç»„ä¸æœç´¢
- å‘½ä»¤æ‰§è¡Œç»Ÿè®¡ï¼ˆå±•ç¤ºæœ€å¸¸ç”¨å‘½ä»¤ï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE command_bookmarks (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  command TEXT NOT NULL,
  description TEXT,
  category TEXT DEFAULT 'general',
  hotkey TEXT,                     -- å¿«æ·é”®ï¼ˆå¦‚ 'Ctrl+Shift+1'ï¼‰
  execute_count INTEGER DEFAULT 0, -- æ‰§è¡Œæ¬¡æ•°
  last_executed_at DATETIME,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_bookmark_category ON command_bookmarks(category);
CREATE INDEX idx_bookmark_execute_count ON command_bookmarks(execute_count DESC);
```

#### å‰ç«¯å¿«æ·é”®é›†æˆ

- ä½¿ç”¨ `@vueuse/core` çš„ `useMagicKeys` ç»‘å®šå¿«æ·é”®
- å¿«æ·é”®å†²çªæ£€æµ‹
- å…¨å±€å¿«æ·é”®é¢æ¿ï¼ˆæ˜¾ç¤ºæ‰€æœ‰ç»‘å®šï¼‰

**é¢„è®¡å·¥ä½œé‡**ï¼š2-3 å¤©

---

## Phase 7: æ™ºèƒ½åŒ–ä¸è‡ªåŠ¨åŒ–

### 7.1 æ™ºèƒ½å‘½ä»¤æ¨èç³»ç»Ÿ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- åŸºäºå†å²å‘½ä»¤åˆ†æï¼Œæ¨èä¸‹ä¸€æ­¥å¯èƒ½çš„æ“ä½œ
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ¨èï¼ˆå¦‚åœ¨ Docker ç›®å½•ä¸‹æ¨è docker å‘½ä»¤ï¼‰
- é”™è¯¯å‘½ä»¤çº æ­£å»ºè®®
- å‘½ä»¤è¡¥å…¨å¢å¼ºï¼ˆåŸºäºæœåŠ¡å™¨ç¯å¢ƒï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åˆ†ææ¨¡å— (`packages/backend/src/analytics/`)

```typescript
// command-pattern.service.ts
class CommandPatternService {
  // åˆ†æå‘½ä»¤åºåˆ—æ¨¡å¼ï¼ˆå¦‚ git add -> git commit -> git pushï¼‰
  async analyzeCommandSequences(connectionId: number): Promise<Pattern[]> {
    const history = await this.getRecentHistory(connectionId, 100);
    return this.findFrequentSequences(history, 3); // æ‰¾å‡º3æ­¥å‘½ä»¤åºåˆ—
  }

  // åŸºäºå½“å‰ç›®å½•æ¨èå‘½ä»¤
  async getContextualSuggestions(connectionId: number, currentPath: string): Promise<Suggestion[]> {
    // æ£€æµ‹ package.json -> æ¨è npm å‘½ä»¤
    // æ£€æµ‹ Dockerfile -> æ¨è docker å‘½ä»¤
    // æ£€æµ‹ .git -> æ¨è git å‘½ä»¤
  }

  // å‘½ä»¤çº é”™ï¼ˆä½¿ç”¨ Levenshtein è·ç¦»ï¼‰
  suggestCorrection(command: string): string | null {
    const commonCommands = ['docker', 'git', 'npm', 'systemctl', 'kubectl'];
    // è®¡ç®—ç¼–è¾‘è·ç¦»ï¼Œè¿”å›æœ€æ¥è¿‘çš„å‘½ä»¤
  }
}
```

#### å‰ç«¯æ™ºèƒ½æç¤º (`packages/frontend/src/features/smart-suggestions/`)

```vue
<!-- SmartSuggestionPanel.vue -->
<template>
  <div class="smart-suggestions">
    <div v-if="suggestions.length" class="suggestion-card">
      <div class="suggestion-header">ğŸ’¡ æ™ºèƒ½æ¨è</div>
      <div v-for="sug in suggestions" :key="sug.id" class="suggestion-item">
        <span class="suggestion-command">{{ sug.command }}</span>
        <span class="suggestion-reason">{{ sug.reason }}</span>
        <button @click="applySuggestion(sug)">æ‰§è¡Œ</button>
      </div>
    </div>
  </div>
</template>
```

**å…³é”®æŠ€æœ¯**ï¼š

- ä½¿ç”¨æ»‘åŠ¨çª—å£åˆ†æå‘½ä»¤åºåˆ—
- TF-IDF ç®—æ³•æå–å‘½ä»¤ç‰¹å¾
- åŸºäºé©¬å°”å¯å¤«é“¾é¢„æµ‹ä¸‹ä¸€ä¸ªå‘½ä»¤

**é¢„è®¡å·¥ä½œé‡**ï¼š6-8 å¤©

---

### 7.2 è‡ªåŠ¨åŒ–å·¡æ£€ä»»åŠ¡ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å®šæ—¶æ‰§è¡Œå¥åº·æ£€æŸ¥è„šæœ¬ï¼ˆç£ç›˜ç©ºé—´ã€å†…å­˜ä½¿ç”¨ã€æœåŠ¡çŠ¶æ€ï¼‰
- å¼‚å¸¸è‡ªåŠ¨å‘Šè­¦ï¼ˆé‚®ä»¶/Webhookï¼‰
- å·¡æ£€æŠ¥å‘Šç”Ÿæˆï¼ˆæ”¯æŒå¯¼å‡º PDF/Markdownï¼‰
- å†å²è¶‹åŠ¿åˆ†æ

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE patrol_tasks (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  description TEXT,
  target_connections TEXT NOT NULL, -- JSON æ•°ç»„ï¼Œç›®æ ‡è¿æ¥ ID
  check_script TEXT NOT NULL,       -- å·¡æ£€è„šæœ¬å†…å®¹
  cron_expression TEXT NOT NULL,    -- Cron è¡¨è¾¾å¼
  alert_threshold TEXT,             -- JSONï¼Œå‘Šè­¦é˜ˆå€¼é…ç½®
  is_enabled BOOLEAN DEFAULT 1,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE patrol_results (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  task_id INTEGER NOT NULL,
  connection_id INTEGER NOT NULL,
  status TEXT NOT NULL,             -- success / warning / error
  metrics TEXT,                     -- JSONï¼Œå·¡æ£€æŒ‡æ ‡æ•°æ®
  alert_triggered BOOLEAN DEFAULT 0,
  executed_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (task_id) REFERENCES patrol_tasks(id) ON DELETE CASCADE
);

CREATE INDEX idx_patrol_results_time ON patrol_results(executed_at DESC);
CREATE INDEX idx_patrol_results_status ON patrol_results(status);
```

#### å·¡æ£€è„šæœ¬ç¤ºä¾‹

```bash
#!/bin/bash
# disk_check.sh
df -h | awk '$5 > 80 {print "WARNING: " $1 " is " $5 " full"}'
free -m | awk 'NR==2{printf "Memory Usage: %.2f%%\n", $3*100/$2 }'
systemctl is-active docker nginx | grep -v active && echo "ERROR: Service down"
```

#### åç«¯è°ƒåº¦å™¨ (`packages/backend/src/patrol/scheduler.ts`)

```typescript
import cron from 'node-cron';

class PatrolScheduler {
  async scheduleTask(task: PatrolTask): Promise<void> {
    cron.schedule(task.cronExpression, async () => {
      const results = await this.executePatrol(task);
      await this.saveResults(results);
      await this.checkAlerts(results, task.alertThreshold);
    });
  }

  async executePatrol(task: PatrolTask): Promise<PatrolResult[]> {
    const results: PatrolResult[] = [];
    for (const connId of task.targetConnections) {
      const output = await this.sshService.executeCommand(connId, task.checkScript);
      results.push(this.parseOutput(output, connId));
    }
    return results;
  }
}
```

#### å‰ç«¯å·¡æ£€é¢æ¿ (`packages/frontend/src/features/patrol/`)

```
patrol/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ PatrolDashboard.vue       # å·¡æ£€ä»ªè¡¨ç›˜ï¼ˆæ˜¾ç¤ºæœ€æ–°çŠ¶æ€ï¼‰
â”‚   â”œâ”€â”€ PatrolTaskEditor.vue      # ä»»åŠ¡ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ PatrolHistory.vue         # å†å²è®°å½•ï¼ˆå›¾è¡¨å±•ç¤ºï¼‰
â”‚   â””â”€â”€ AlertRuleEditor.vue       # å‘Šè­¦è§„åˆ™é…ç½®
â””â”€â”€ composables/
    â””â”€â”€ usePatrolScheduler.ts
```

**å…³é”®åŠŸèƒ½**ï¼š

- æ”¯æŒé¢„è®¾å·¡æ£€æ¨¡æ¿ï¼ˆç³»ç»Ÿèµ„æºã€æœåŠ¡å¥åº·ã€æ—¥å¿—åˆ†æï¼‰
- è¶‹åŠ¿å›¾è¡¨ï¼ˆä½¿ç”¨ Chart.js ç»˜åˆ¶æ—¶é—´åºåˆ—ï¼‰
- æŠ¥å‘Šå¯¼å‡ºï¼ˆä½¿ç”¨ jsPDF ç”Ÿæˆ PDFï¼‰

**é¢„è®¡å·¥ä½œé‡**ï¼š7-10 å¤©

---

### 7.3 æ–‡ä»¶è‡ªåŠ¨å¤‡ä»½ä¸åŒæ­¥ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å®šæ—¶å¤‡ä»½æŒ‡å®šè¿œç¨‹ç›®å½•åˆ°æœ¬åœ°
- æ”¯æŒå¢é‡å¤‡ä»½ï¼ˆrsync æ¨¡å¼ï¼‰
- å¤‡ä»½ç‰ˆæœ¬ç®¡ç†ï¼ˆä¿ç•™æœ€è¿‘ N ä¸ªç‰ˆæœ¬ï¼‰
- è¿œç¨‹ç›®å½•å˜åŒ–ç›‘æ§ï¼ˆç±»ä¼¼ inotifyï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE backup_jobs (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  connection_id INTEGER NOT NULL,
  remote_path TEXT NOT NULL,
  local_path TEXT NOT NULL,         -- æœ¬åœ°å­˜å‚¨è·¯å¾„ï¼ˆç›¸å¯¹äº data ç›®å½•ï¼‰
  backup_mode TEXT DEFAULT 'full',  -- full / incremental
  schedule TEXT NOT NULL,           -- Cron è¡¨è¾¾å¼
  retention_count INTEGER DEFAULT 7,-- ä¿ç•™ç‰ˆæœ¬æ•°
  is_enabled BOOLEAN DEFAULT 1,
  last_backup_at DATETIME,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (connection_id) REFERENCES connections(id)
);

CREATE TABLE backup_history (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  job_id INTEGER NOT NULL,
  backup_path TEXT NOT NULL,
  backup_size INTEGER,
  file_count INTEGER,
  status TEXT NOT NULL,
  error_message TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (job_id) REFERENCES backup_jobs(id) ON DELETE CASCADE
);
```

#### åç«¯å¤‡ä»½æœåŠ¡ (`packages/backend/src/backup/service.ts`)

```typescript
import { Client } from 'ssh2';
import fs from 'fs-extra';
import archiver from 'archiver';

class BackupService {
  async executeBackup(job: BackupJob): Promise<void> {
    const sftp = await this.connectSFTP(job.connectionId);
    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
    const backupDir = `${job.localPath}/${timestamp}`;

    await fs.ensureDir(backupDir);

    if (job.backupMode === 'incremental') {
      await this.incrementalBackup(sftp, job.remotePath, backupDir);
    } else {
      await this.fullBackup(sftp, job.remotePath, backupDir);
    }

    // å‹ç¼©å¤‡ä»½
    await this.compressBackup(backupDir);

    // æ¸…ç†æ—§å¤‡ä»½
    await this.cleanOldBackups(job);
  }

  async incrementalBackup(sftp: any, remotePath: string, localPath: string) {
    // æ¯”è¾ƒæ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼Œåªä¸‹è½½å˜åŒ–çš„æ–‡ä»¶
    const remoteFiles = await this.listRemoteFiles(sftp, remotePath);
    const lastBackup = await this.getLastBackupManifest(localPath);

    for (const file of remoteFiles) {
      if (!lastBackup[file.path] || file.mtime > lastBackup[file.path].mtime) {
        await this.downloadFile(sftp, file.path, localPath);
      }
    }
  }
}
```

**å‰ç«¯ç•Œé¢**ï¼š

- å¤‡ä»½ä»»åŠ¡ç®¡ç†åˆ—è¡¨
- å¤‡ä»½å†å²æŸ¥çœ‹å™¨ï¼ˆå¯é¢„è§ˆå¤‡ä»½å†…å®¹ï¼‰
- ä¸€é”®è¿˜åŸåŠŸèƒ½

**é¢„è®¡å·¥ä½œé‡**ï¼š5-7 å¤©

---

## Phase 8: æ•°æ®æ´å¯Ÿä¸å¯è§†åŒ–

### 8.1 ä¸ªäººè¿ç»´ä»ªè¡¨ç›˜ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å®æ—¶å±•ç¤ºæ‰€æœ‰æœåŠ¡å™¨å…³é”®æŒ‡æ ‡ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œï¼‰
- è¿æ¥æ´»åŠ¨çƒ­åŠ›å›¾ï¼ˆæ˜¾ç¤ºæ¯å¤©æœ€æ´»è·ƒçš„æ—¶é—´æ®µï¼‰
- å‘½ä»¤æ‰§è¡Œç»Ÿè®¡ï¼ˆTop 10 å‘½ä»¤ã€é”™è¯¯ç‡è¶‹åŠ¿ï¼‰
- ä¸ªæ€§åŒ–ç»„ä»¶å¸ƒå±€ï¼ˆæ‹–æ‹½è°ƒæ•´ä»ªè¡¨ç›˜ï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### å‰ç«¯ä»ªè¡¨ç›˜ (`packages/frontend/src/features/dashboard/`)

```
dashboard/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ DashboardGrid.vue         # ç½‘æ ¼å¸ƒå±€å®¹å™¨ï¼ˆvue-grid-layoutï¼‰
â”‚   â”œâ”€â”€ widgets/
â”‚   â”‚   â”œâ”€â”€ SystemMetricsWidget.vue    # ç³»ç»ŸæŒ‡æ ‡å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ ActivityHeatmapWidget.vue  # æ´»åŠ¨çƒ­åŠ›å›¾
â”‚   â”‚   â”œâ”€â”€ CommandStatsWidget.vue     # å‘½ä»¤ç»Ÿè®¡
â”‚   â”‚   â”œâ”€â”€ ConnectionStatusWidget.vue # è¿æ¥çŠ¶æ€æ€»è§ˆ
â”‚   â”‚   â””â”€â”€ QuickActionWidget.vue      # å¿«é€Ÿæ“ä½œé¢æ¿
â”‚   â””â”€â”€ WidgetSelector.vue        # ç»„ä»¶é€‰æ‹©å™¨
â””â”€â”€ stores/
    â””â”€â”€ dashboard.store.ts        # ä¿å­˜å¸ƒå±€é…ç½®
```

#### æ•°æ®é‡‡é›†

```typescript
// packages/backend/src/metrics/collector.ts
class MetricsCollector {
  async collectSystemMetrics(connectionId: number): Promise<Metrics> {
    const commands = {
      cpu: "top -bn1 | grep 'Cpu(s)' | awk '{print $2}'",
      memory: "free | grep Mem | awk '{print ($3/$2)*100}'",
      disk: "df -h / | tail -1 | awk '{print $5}'",
      network: "cat /proc/net/dev | grep eth0 | awk '{print $2, $10}'",
    };

    const metrics: Metrics = {};
    for (const [key, cmd] of Object.entries(commands)) {
      metrics[key] = await this.executeAndParse(connectionId, cmd);
    }

    return metrics;
  }
}
```

#### WebSocket å®æ—¶æ¨é€

```typescript
// æ¯ 10 ç§’æ¨é€ä¸€æ¬¡æŒ‡æ ‡æ•°æ®
setInterval(async () => {
  const connections = await getActiveConnections();
  for (const conn of connections) {
    const metrics = await metricsCollector.collect(conn.id);
    wsManager.sendToUser(conn.userId, {
      type: 'metrics-update',
      data: { connectionId: conn.id, metrics },
    });
  }
}, 10000);
```

**å›¾è¡¨åº“**ï¼š

- Chart.jsï¼ˆæ—¶é—´åºåˆ—æŠ˜çº¿å›¾ã€é¥¼å›¾ï¼‰
- Apache EChartsï¼ˆçƒ­åŠ›å›¾ã€ä»ªè¡¨ç›˜ï¼‰

**é¢„è®¡å·¥ä½œé‡**ï¼š6-8 å¤©

---

### 8.2 å‘½ä»¤æ‰§è¡Œåˆ†ææŠ¥å‘Š â­â­

**åŠŸèƒ½æè¿°**ï¼š

- æ¯å‘¨/æ¯æœˆè‡ªåŠ¨ç”Ÿæˆè¿ç»´æŠ¥å‘Š
- ç»Ÿè®¡æ•°æ®ï¼šå‘½ä»¤æ‰§è¡Œæ¬¡æ•°ã€è¿æ¥æ—¶é•¿ã€é”™è¯¯ç‡ã€æ´»è·ƒæœåŠ¡å™¨
- å¯è§†åŒ–æŠ¥å‘Šï¼ˆå›¾è¡¨ + Markdownï¼‰
- å¯¼å‡ºåŠŸèƒ½ï¼ˆPDF/HTMLï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æŠ¥å‘Šç”Ÿæˆå™¨ (`packages/backend/src/reports/generator.ts`)

```typescript
interface WeeklyReport {
  period: { start: string; end: string };
  totalCommands: number;
  topCommands: Array<{ command: string; count: number }>;
  connectionStats: {
    totalSessions: number;
    avgDuration: number;
    topServers: string[];
  };
  errorRate: number;
  insights: string[]; // AI ç”Ÿæˆçš„æ´å¯Ÿ
}

class ReportGenerator {
  async generateWeeklyReport(): Promise<WeeklyReport> {
    const startDate = dayjs().subtract(7, 'day').toDate();
    const endDate = new Date();

    const commands = await this.queryCommands(startDate, endDate);
    const sessions = await this.querySessions(startDate, endDate);

    return {
      period: { start: startDate.toISOString(), end: endDate.toISOString() },
      totalCommands: commands.length,
      topCommands: this.aggregateTopCommands(commands, 10),
      connectionStats: this.calculateConnectionStats(sessions),
      errorRate: this.calculateErrorRate(commands),
      insights: await this.aiOpsService.generateInsights(commands, sessions),
    };
  }

  async exportToPDF(report: WeeklyReport): Promise<Buffer> {
    // ä½¿ç”¨ puppeteer å°† HTML æŠ¥å‘Šè½¬ä¸º PDF
  }
}
```

#### å‰ç«¯æŠ¥å‘ŠæŸ¥çœ‹å™¨

```vue
<!-- ReportViewer.vue -->
<template>
  <div class="report-viewer">
    <div class="report-header">
      <h2>è¿ç»´å‘¨æŠ¥ - {{ report.period.start }} è‡³ {{ report.period.end }}</h2>
      <button @click="exportPDF">å¯¼å‡º PDF</button>
    </div>

    <div class="report-section">
      <h3>å‘½ä»¤æ‰§è¡Œç»Ÿè®¡</h3>
      <BarChart :data="report.topCommands" />
    </div>

    <div class="report-section">
      <h3>AI æ´å¯Ÿ</h3>
      <ul>
        <li v-for="insight in report.insights" :key="insight">
          {{ insight }}
        </li>
      </ul>
    </div>
  </div>
</template>
```

**é¢„è®¡å·¥ä½œé‡**ï¼š4-5 å¤©

---

### 8.3 æ—¥å¿—èšåˆä¸æœç´¢ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- è‡ªåŠ¨æ”¶é›†è¿œç¨‹æœåŠ¡å™¨æ—¥å¿—ï¼ˆsyslogã€åº”ç”¨æ—¥å¿—ï¼‰
- å…¨æ–‡æœç´¢ä¸ç­›é€‰ï¼ˆæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼‰
- æ—¥å¿—é«˜äº®æ˜¾ç¤ºï¼ˆé”™è¯¯ã€è­¦å‘Šã€è°ƒè¯•ï¼‰
- æ—¥å¿—ç»Ÿè®¡åˆ†æï¼ˆé”™è¯¯é¢‘ç‡ã€å…³é”®å­—è¶‹åŠ¿ï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ—¥å¿—æ”¶é›†å™¨ (`packages/backend/src/logs/collector.ts`)

```typescript
class LogCollector {
  async collectLogs(connectionId: number, logPath: string): Promise<void> {
    const sftp = await this.connectSFTP(connectionId);
    const logContent = await sftp.readFile(logPath);

    // è§£ææ—¥å¿—å¹¶å­˜å‚¨
    const entries = this.parseLogEntries(logContent);
    await this.saveToDatabase(entries, connectionId);
  }

  parseLogEntries(content: string): LogEntry[] {
    // æ”¯æŒå¤šç§æ—¥å¿—æ ¼å¼ï¼šsyslogã€JSONã€è‡ªå®šä¹‰æ­£åˆ™
    const patterns = {
      syslog: /^(\w+\s+\d+\s+\d+:\d+:\d+)\s+(\S+)\s+(\S+):\s+(.+)$/,
      json: /^{.*}$/,
      nginx: /^(\S+)\s+-\s+-\s+\[(.*?)\]\s+"(.*?)"\s+(\d+)\s+(\d+)/,
    };

    // è‡ªåŠ¨æ£€æµ‹æ ¼å¼å¹¶è§£æ
  }
}
```

#### æ•°æ®åº“è®¾è®¡ï¼ˆä½¿ç”¨ FTS5 å…¨æ–‡æœç´¢ï¼‰

```sql
CREATE VIRTUAL TABLE logs_fts USING fts5(
  connection_id,
  log_path,
  level,        -- INFO / WARN / ERROR / DEBUG
  timestamp,
  message,
  tokenize='porter'
);

-- æœç´¢ç¤ºä¾‹
SELECT * FROM logs_fts WHERE message MATCH 'error OR exception'
ORDER BY timestamp DESC LIMIT 100;
```

#### å‰ç«¯æ—¥å¿—æŸ¥çœ‹å™¨ (`packages/frontend/src/features/logs/`)

```
logs/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ LogViewer.vue          # æ—¥å¿—åˆ—è¡¨ï¼ˆè™šæ‹Ÿæ»šåŠ¨ï¼‰
â”‚   â”œâ”€â”€ LogSearchBar.vue       # æœç´¢æ¡†ï¼ˆæ”¯æŒé«˜çº§ç­›é€‰ï¼‰
â”‚   â”œâ”€â”€ LogLevelFilter.vue     # æ—¥å¿—çº§åˆ«ç­›é€‰å™¨
â”‚   â””â”€â”€ LogStatistics.vue      # ç»Ÿè®¡å›¾è¡¨
â””â”€â”€ composables/
    â””â”€â”€ useLogSearch.ts        # æœç´¢é€»è¾‘ï¼ˆdebounceï¼‰
```

**å…³é”®æŠ€æœ¯**ï¼š

- ä½¿ç”¨ `virtual-scroller` æ¸²æŸ“å¤§é‡æ—¥å¿—æ¡ç›®
- æ—¥å¿—é«˜äº®ä½¿ç”¨ `highlight.js` æˆ–è‡ªå®šä¹‰æ­£åˆ™
- å®æ—¶æ—¥å¿—æµï¼ˆWebSocket æ¨é€ï¼‰

**é¢„è®¡å·¥ä½œé‡**ï¼š6-8 å¤©

---

## Phase 9: è·¨å¹³å°ä¸åŒæ­¥

### 9.1 æµè§ˆå™¨æ‰©å±•ç‰ˆæœ¬ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- Chrome/Edge/Firefox æµè§ˆå™¨æ‰©å±•
- å¿«é€Ÿè¿æ¥åˆ°æ”¶è—çš„æœåŠ¡å™¨ï¼ˆæ— éœ€æ‰“å¼€å®Œæ•´ Web åº”ç”¨ï¼‰
- å…¨å±€å¿«æ·é”®å”¤èµ·ç»ˆç«¯é¢æ¿
- ä¸ Web ç‰ˆæ•°æ®åŒæ­¥

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ‰©å±•æ¶æ„

```
browser-extension/
â”œâ”€â”€ manifest.json              # æ‰©å±•é…ç½®
â”œâ”€â”€ background.js              # åå°è„šæœ¬ï¼ˆç›‘å¬å¿«æ·é”®ï¼‰
â”œâ”€â”€ popup/
â”‚   â”œâ”€â”€ index.html             # å¼¹çª—ç•Œé¢
â”‚   â””â”€â”€ popup.vue              # è¿æ¥åˆ—è¡¨
â””â”€â”€ content/
    â””â”€â”€ inject.js              # æ³¨å…¥è„šæœ¬ï¼ˆå¯é€‰ï¼‰
```

#### manifest.json ç¤ºä¾‹

```json
{
  "manifest_version": 3,
  "name": "Nexus Terminal QuickConnect",
  "version": "1.0.0",
  "permissions": ["storage", "tabs"],
  "commands": {
    "_execute_action": {
      "suggested_key": {
        "default": "Ctrl+Shift+T"
      }
    }
  },
  "action": {
    "default_popup": "popup/index.html",
    "default_icon": "icon.png"
  }
}
```

#### æ•°æ®åŒæ­¥æ–¹æ¡ˆ

- ä½¿ç”¨ `chrome.storage.sync` å­˜å‚¨è¿æ¥åˆ—è¡¨ï¼ˆåŠ å¯†ï¼‰
- æ‰©å±•ä¸ Web åº”ç”¨é€šè¿‡ API åŒæ­¥æ•°æ®
- å¯é€‰ï¼šæ”¯æŒå¯¼å‡º/å¯¼å…¥é…ç½®æ–‡ä»¶

**é¢„è®¡å·¥ä½œé‡**ï¼š4-6 å¤©

---

### 9.2 ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ– â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- PWA ç¦»çº¿æ”¯æŒå¢å¼º
- ç§»åŠ¨ç«¯æ‰‹åŠ¿ä¼˜åŒ–ï¼ˆæ»‘åŠ¨åˆ‡æ¢æ ‡ç­¾ã€åŒæŒ‡ç¼©æ”¾ï¼‰
- ç§»åŠ¨ç«¯ä¸“å±å¸ƒå±€ï¼ˆç®€åŒ–ç‰ˆç•Œé¢ï¼‰
- è§¦æ§é”®ç›˜å®šåˆ¶ï¼ˆCtrl/Alt/Esc ç­‰ç‰¹æ®Šé”®ï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### PWA å¢å¼º (`packages/frontend/public/service-worker.js`)

```javascript
// ç¼“å­˜ç­–ç•¥ï¼šNetwork First for API, Cache First for static assets
self.addEventListener('fetch', (event) => {
  if (event.request.url.includes('/api/')) {
    event.respondWith(networkFirst(event.request));
  } else {
    event.respondWith(cacheFirst(event.request));
  }
});
```

#### ç§»åŠ¨ç«¯æ£€æµ‹

```typescript
// packages/frontend/src/composables/useDeviceDetection.ts
export function useDeviceDetection() {
  const isMobile = computed(() => {
    return /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  });

  const isTouchDevice = computed(() => {
    return 'ontouchstart' in window;
  });

  const deviceType = computed(() => {
    if (isMobile.value) return 'mobile';
    if (isTouchDevice.value) return 'tablet';
    return 'desktop';
  });

  return { isMobile, isTouchDevice, deviceType };
}
```

#### ç§»åŠ¨ç«¯ç»ˆç«¯é”®ç›˜ (`packages/frontend/src/components/mobile/VirtualKeyboard.vue`)

```vue
<template>
  <div class="virtual-keyboard">
    <div class="keyboard-row">
      <button @click="sendKey('Ctrl')">Ctrl</button>
      <button @click="sendKey('Alt')">Alt</button>
      <button @click="sendKey('Esc')">Esc</button>
      <button @click="sendKey('Tab')">Tab</button>
    </div>
    <div class="keyboard-row">
      <button @click="sendKey('ArrowUp')">â†‘</button>
      <button @click="sendKey('ArrowDown')">â†“</button>
      <button @click="sendKey('ArrowLeft')">â†</button>
      <button @click="sendKey('ArrowRight')">â†’</button>
    </div>
  </div>
</template>
```

**æ‰‹åŠ¿æ”¯æŒ**ï¼š

- ä½¿ç”¨ `@vueuse/gesture` æˆ– `hammer.js`
- åŒæŒ‡æåˆç¼©æ”¾ç»ˆç«¯å­—ä½“
- å·¦å³æ»‘åŠ¨åˆ‡æ¢æ ‡ç­¾é¡µ
- é•¿æŒ‰æ˜¾ç¤ºå³é”®èœå•

**é¢„è®¡å·¥ä½œé‡**ï¼š5-7 å¤©

---

### 9.3 é…ç½®äº‘åŒæ­¥ï¼ˆå¯é€‰ï¼‰ â­

**åŠŸèƒ½æè¿°**ï¼š

- æ”¯æŒå°†é…ç½®åŒæ­¥åˆ°äº‘ç«¯ï¼ˆè‡ªå»ºæˆ–ç¬¬ä¸‰æ–¹ S3ï¼‰
- å¤šè®¾å¤‡é…ç½®åŒæ­¥ï¼ˆè¿æ¥åˆ—è¡¨ã€ä¸»é¢˜è®¾ç½®ã€å¿«æ·é”®ï¼‰
- ç«¯åˆ°ç«¯åŠ å¯†ï¼ˆæœ¬åœ°åŠ å¯†åä¸Šä¼ ï¼‰
- å†²çªè§£å†³ç­–ç•¥ï¼ˆæ—¶é—´æˆ³ä¼˜å…ˆï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### åç«¯åŒæ­¥æœåŠ¡ (`packages/backend/src/sync/`)

```typescript
interface SyncPayload {
  version: number;
  timestamp: string;
  encrypted_data: string; // AES-256 åŠ å¯†
  checksum: string; // SHA-256 æ ¡éªŒ
}

class SyncService {
  async uploadConfig(userId: string, config: any): Promise<void> {
    const encrypted = await this.encrypt(JSON.stringify(config));
    const payload: SyncPayload = {
      version: Date.now(),
      timestamp: new Date().toISOString(),
      encrypted_data: encrypted,
      checksum: this.calculateChecksum(encrypted),
    };

    // ä¸Šä¼ åˆ° S3 æˆ–æœ¬åœ°å­˜å‚¨
    await this.storage.put(`sync/${userId}/config.json`, payload);
  }

  async downloadConfig(userId: string): Promise<any> {
    const payload = await this.storage.get(`sync/${userId}/config.json`);
    const decrypted = await this.decrypt(payload.encrypted_data);
    return JSON.parse(decrypted);
  }
}
```

#### å‰ç«¯åŒæ­¥è§¦å‘å™¨

- ç™»å½•åè‡ªåŠ¨æ‹‰å–æœ€æ–°é…ç½®
- é…ç½®ä¿®æ”¹åå»¶è¿Ÿ 5 ç§’è‡ªåŠ¨ä¸Šä¼ 
- æ‰‹åŠ¨åŒæ­¥æŒ‰é’®ï¼ˆç«‹å³æ¨é€/æ‹‰å–ï¼‰

**éšç§ä¿æŠ¤**ï¼š

- åŠ å¯†å¯†é’¥ç”±ç”¨æˆ·è®¾ç½®çš„ä¸»å¯†ç æ´¾ç”Ÿï¼ˆPBKDF2ï¼‰
- æœåŠ¡å™¨æ— æ³•è§£å¯†ç”¨æˆ·æ•°æ®
- å¯é€‰ï¼šå®Œå…¨ç¦ç”¨äº‘åŒæ­¥ï¼Œä»…æœ¬åœ°å­˜å‚¨

**é¢„è®¡å·¥ä½œé‡**ï¼š6-8 å¤©

---

## Phase 10: é«˜çº§ç»ˆç«¯èƒ½åŠ›

### 10.1 ç»ˆç«¯å½•åˆ¶ä¸å›æ”¾ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å½•åˆ¶å®Œæ•´ç»ˆç«¯ä¼šè¯ï¼ˆåŒ…æ‹¬é¢œè‰²ã€å…‰æ ‡ç§»åŠ¨ï¼‰
- å›æ”¾å½•åˆ¶å†…å®¹ï¼ˆæ”¯æŒæš‚åœã€å€é€Ÿæ’­æ”¾ï¼‰
- å¯¼å‡ºä¸º asciinema æ ¼å¼æˆ– GIF
- è‡ªåŠ¨å½•åˆ¶é‡è¦ä¼šè¯

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE session_recordings (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  connection_id INTEGER NOT NULL,
  title TEXT,
  duration INTEGER NOT NULL,       -- å½•åˆ¶æ—¶é•¿ï¼ˆç§’ï¼‰
  recording_data TEXT NOT NULL,    -- JSON æ ¼å¼ï¼Œå­˜å‚¨äº‹ä»¶æµ
  file_path TEXT,                  -- å¯é€‰ï¼šå­˜å‚¨ä¸ºæ–‡ä»¶
  is_auto BOOLEAN DEFAULT 0,       -- æ˜¯å¦ä¸ºè‡ªåŠ¨å½•åˆ¶
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (connection_id) REFERENCES connections(id)
);
```

#### recording_data æ ¼å¼ï¼ˆå…¼å®¹ asciinemaï¼‰

```json
{
  "version": 2,
  "width": 80,
  "height": 24,
  "timestamp": 1234567890,
  "events": [
    [0.5, "o", "$ ls -la\r\n"],
    [1.2, "o", "total 48\r\n"],
    [1.3, "o", "drwxr-xr-x  5 user  staff  160 Jan 1 12:00 .\r\n"]
  ]
}
```

#### åç«¯å½•åˆ¶æœåŠ¡ (`packages/backend/src/recordings/service.ts`)

```typescript
class RecordingService {
  private recordings = new Map<string, RecordingSession>();

  startRecording(sessionId: string): void {
    const recording: RecordingSession = {
      startTime: Date.now(),
      events: [],
      metadata: { width: 80, height: 24 },
    };
    this.recordings.set(sessionId, recording);
  }

  captureEvent(sessionId: string, data: string): void {
    const recording = this.recordings.get(sessionId);
    if (!recording) return;

    const elapsed = (Date.now() - recording.startTime) / 1000;
    recording.events.push([elapsed, 'o', data]);
  }

  async stopRecording(sessionId: string): Promise<void> {
    const recording = this.recordings.get(sessionId);
    if (!recording) return;

    await this.saveToDatabase({
      connectionId: sessionId,
      duration: (Date.now() - recording.startTime) / 1000,
      recordingData: JSON.stringify(recording),
    });

    this.recordings.delete(sessionId);
  }
}
```

#### å‰ç«¯æ’­æ”¾å™¨ (`packages/frontend/src/features/recordings/Player.vue`)

```vue
<template>
  <div class="recording-player">
    <div ref="terminalContainer" class="terminal-container"></div>
    <div class="player-controls">
      <button @click="togglePlayPause">{{ isPlaying ? 'â¸' : 'â–¶' }}</button>
      <input
        type="range"
        :value="currentTime"
        :max="duration"
        @input="seekTo($event.target.value)"
      />
      <select v-model="playbackSpeed">
        <option value="0.5">0.5x</option>
        <option value="1">1x</option>
        <option value="2">2x</option>
      </select>
    </div>
  </div>
</template>

<script setup lang="ts">
import { Terminal } from 'xterm';
import AsciinemaPlayer from 'asciinema-player';

const player = ref<AsciinemaPlayer>();

const loadRecording = async (recordingId: number) => {
  const data = await api.getRecording(recordingId);
  player.value = AsciinemaPlayer.create(data, terminalContainer.value, {
    speed: playbackSpeed.value,
    autoPlay: false,
  });
};
</script>
```

**å¯¼å‡ºåŠŸèƒ½**ï¼š

- asciinema æ ¼å¼ï¼ˆ`.cast` æ–‡ä»¶ï¼‰
- GIF åŠ¨å›¾ï¼ˆä½¿ç”¨ `asciicast2gif`ï¼‰
- HTML åµŒå…¥ä»£ç ï¼ˆå¯åˆ†äº«ï¼‰

**é¢„è®¡å·¥ä½œé‡**ï¼š7-10 å¤©

---

### 10.2 ç»ˆç«¯åˆ†å±ä¸å¸ƒå±€å¢å¼º â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å•ä¸ªæ ‡ç­¾é¡µå†…æ”¯æŒå¤šç»ˆç«¯åˆ†å±ï¼ˆç±»ä¼¼ tmuxï¼‰
- é¢„è®¾å¸ƒå±€æ¨¡æ¿ï¼ˆä¸¤åˆ—ã€ä¸‰åˆ—ã€ç”°å­—æ ¼ï¼‰
- åˆ†å±é—´å¿«æ·é”®åˆ‡æ¢
- åŒæ­¥è¾“å…¥æ¨¡å¼ï¼ˆå¤šä¸ªç»ˆç«¯åŒæ—¶è¾“å…¥ï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### å‰ç«¯åˆ†å±ç»„ä»¶ (`packages/frontend/src/components/terminal/SplitTerminal.vue`)

```vue
<template>
  <div class="split-terminal" :style="gridStyle">
    <div
      v-for="(pane, index) in panes"
      :key="pane.id"
      class="terminal-pane"
      :class="{ active: activePane === index }"
    >
      <TerminalView :session-id="pane.sessionId" />
      <div class="pane-actions">
        <button @click="splitHorizontal(index)">â–</button>
        <button @click="splitVertical(index)">|</button>
        <button @click="closePane(index)">âœ–</button>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
interface Pane {
  id: string;
  sessionId: string;
  position: { row: number; col: number };
  size: { width: number; height: number };
}

const panes = ref<Pane[]>([
  {
    id: 'pane-1',
    sessionId: 'session-1',
    position: { row: 0, col: 0 },
    size: { width: 100, height: 100 },
  },
]);

const splitHorizontal = (index: number) => {
  const pane = panes.value[index];
  // å°†å½“å‰ pane é«˜åº¦å‡åŠï¼Œæ–°å¢ä¸‹æ–¹ pane
  pane.size.height = 50;
  panes.value.push({
    id: `pane-${Date.now()}`,
    sessionId: `session-${Date.now()}`,
    position: { row: pane.position.row + 1, col: pane.position.col },
    size: { width: pane.size.width, height: 50 },
  });
};
</script>
```

#### åŒæ­¥è¾“å…¥æ¨¡å¼

```typescript
// packages/frontend/src/composables/useSyncInput.ts
export function useSyncInput(panes: Ref<Pane[]>) {
  const isSyncMode = ref(false);

  const handleInput = (data: string) => {
    if (!isSyncMode.value) return;

    // å‘æ‰€æœ‰ pane çš„ç»ˆç«¯å‘é€ç›¸åŒè¾“å…¥
    panes.value.forEach((pane) => {
      sendToTerminal(pane.sessionId, data);
    });
  };

  return { isSyncMode, handleInput };
}
```

**å¿«æ·é”®**ï¼š

- `Ctrl+Shift+D`ï¼šæ°´å¹³åˆ†å‰²
- `Ctrl+Shift+E`ï¼šå‚ç›´åˆ†å‰²
- `Ctrl+Shift+W`ï¼šå…³é—­å½“å‰é¢æ¿
- `Ctrl+Shift+Arrow`ï¼šåˆ‡æ¢ç„¦ç‚¹

**é¢„è®¡å·¥ä½œé‡**ï¼š6-8 å¤©

---

### 10.3 å‘½ä»¤è¾“å‡ºå¢å¼º â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å‘½ä»¤è¾“å‡ºè¯­æ³•é«˜äº®ï¼ˆJSONã€YAMLã€æ—¥å¿—ç­‰ï¼‰
- è¡¨æ ¼è‡ªåŠ¨æ ¼å¼åŒ–ï¼ˆæ£€æµ‹åˆ—å¯¹é½ï¼‰
- é“¾æ¥è‡ªåŠ¨æ£€æµ‹ï¼ˆURLã€æ–‡ä»¶è·¯å¾„ï¼‰
- è¾“å‡ºæŠ˜å ï¼ˆé•¿è¾“å‡ºè‡ªåŠ¨æŠ˜å ï¼Œå¯å±•å¼€ï¼‰

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### è¾“å‡ºå¤„ç†å™¨ (`packages/frontend/src/utils/output-processor.ts`)

```typescript
class OutputProcessor {
  process(output: string): ProcessedOutput {
    // 1. æ£€æµ‹è¾“å‡ºç±»å‹
    const type = this.detectType(output);

    // 2. åº”ç”¨å¯¹åº”å¤„ç†
    switch (type) {
      case 'json':
        return this.highlightJSON(output);
      case 'table':
        return this.formatTable(output);
      case 'log':
        return this.highlightLog(output);
      default:
        return this.linkify(output);
    }
  }

  detectType(output: string): OutputType {
    if (/^\s*[{\[]/.test(output)) return 'json';
    if (/^(\S+\s+){3,}\n-+\n/.test(output)) return 'table';
    if (/\d{4}-\d{2}-\d{2}/.test(output)) return 'log';
    return 'text';
  }

  highlightJSON(json: string): string {
    try {
      const parsed = JSON.parse(json);
      return `<pre class="json-output">${highlight(JSON.stringify(parsed, null, 2), 'json')}</pre>`;
    } catch {
      return json;
    }
  }

  formatTable(table: string): string {
    // æ£€æµ‹åˆ—å®½ï¼Œæ·»åŠ  CSS å¯¹é½
    const lines = table.split('\n');
    const columns = this.detectColumns(lines);
    return this.renderTable(lines, columns);
  }
}
```

#### Xterm æ’ä»¶é›†æˆ

```typescript
// packages/frontend/src/features/terminal/addons/output-enhancer.ts
import { Terminal, ITerminalAddon } from 'xterm';

export class OutputEnhancerAddon implements ITerminalAddon {
  activate(terminal: Terminal): void {
    const originalWrite = terminal.write.bind(terminal);

    terminal.write = (data: string | Uint8Array) => {
      if (typeof data === 'string') {
        data = this.processOutput(data);
      }
      return originalWrite(data);
    };
  }

  processOutput(data: string): string {
    // åº”ç”¨è¾“å‡ºå¢å¼º
    return outputProcessor.process(data);
  }
}
```

**é¢„è®¡å·¥ä½œé‡**ï¼š4-6 å¤©

---

## Phase 11: ä¸ªäººçŸ¥è¯†åº“

### 11.1 å†…ç½®æ–‡æ¡£ä¸ç¬”è®°ç³»ç»Ÿ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- Markdown ç¬”è®°ç¼–è¾‘å™¨ï¼ˆé›†æˆåˆ°ä¾§è¾¹æ ï¼‰
- æ”¯æŒä»£ç å—é«˜äº®ä¸è¿è¡Œ
- ç¬”è®°ä¸è¿æ¥å…³è”ï¼ˆä¸ºæ¯ä¸ªæœåŠ¡å™¨åˆ›å»ºç¬”è®°ï¼‰
- å…¨æ–‡æœç´¢ç¬”è®°å†…å®¹

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE notes (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,
  content TEXT NOT NULL,         -- Markdown å†…å®¹
  connection_id INTEGER,         -- å¯é€‰ï¼šå…³è”è¿æ¥
  tags TEXT,                     -- JSON æ•°ç»„ï¼Œæ ‡ç­¾
  is_pinned BOOLEAN DEFAULT 0,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (connection_id) REFERENCES connections(id)
);

CREATE VIRTUAL TABLE notes_fts USING fts5(title, content, tags);
```

#### å‰ç«¯ç¼–è¾‘å™¨ (`packages/frontend/src/features/notes/`)

```
notes/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ NoteEditor.vue         # Markdown ç¼–è¾‘å™¨ï¼ˆTipTap æˆ– Toast UIï¼‰
â”‚   â”œâ”€â”€ NoteList.vue           # ç¬”è®°åˆ—è¡¨ï¼ˆä¾§è¾¹æ ï¼‰
â”‚   â”œâ”€â”€ NotePreview.vue        # é¢„è§ˆæ¨¡å¼
â”‚   â””â”€â”€ CodeBlockRunner.vue    # ä»£ç å—æ‰§è¡Œå™¨
â””â”€â”€ stores/
    â””â”€â”€ notes.store.ts
```

#### ä»£ç å—æ‰§è¡ŒåŠŸèƒ½

````vue
<!-- åœ¨ Markdown ä¸­æ ‡è®°å¯æ‰§è¡Œä»£ç å— -->
```bash {runnable} df -h
````

<!-- å‰ç«¯æ£€æµ‹åˆ° {runnable} æ ‡è®°ï¼Œæ˜¾ç¤º"è¿è¡Œ"æŒ‰é’® -->

<button @click="runCodeBlock(codeBlock)">â–¶ è¿è¡Œ</button>

````

**å¿«æ·é”®**ï¼š
- `Ctrl+N`ï¼šæ–°å»ºç¬”è®°
- `Ctrl+P`ï¼šå¿«é€Ÿæœç´¢ç¬”è®°
- `Ctrl+L`ï¼šæ’å…¥å½“å‰è¿æ¥ä¿¡æ¯

**é¢„è®¡å·¥ä½œé‡**ï¼š6-8 å¤©

---

### 11.2 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆåº“ â­â­

**åŠŸèƒ½æè¿°**ï¼š
- è®°å½•é‡åˆ°çš„é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ
- è‡ªåŠ¨å…³è”å‘½ä»¤å†å²ï¼ˆä»å¤±è´¥å‘½ä»¤åˆ›å»ºé—®é¢˜è®°å½•ï¼‰
- é—®é¢˜åˆ†ç±»ä¸æ ‡ç­¾
- AI è¾…åŠ©ç”Ÿæˆè§£å†³æ–¹æ¡ˆ

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡
```sql
CREATE TABLE troubleshooting_entries (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,
  problem_description TEXT NOT NULL,
  solution TEXT NOT NULL,
  related_commands TEXT,        -- JSON æ•°ç»„ï¼Œç›¸å…³å‘½ä»¤
  category TEXT,
  severity TEXT,                -- low / medium / high / critical
  occurrence_count INTEGER DEFAULT 1,
  last_occurred_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
````

#### è‡ªåŠ¨é—®é¢˜æ£€æµ‹

```typescript
// packages/backend/src/troubleshooting/detector.ts
class ProblemDetector {
  async analyzeFailedCommand(command: string, output: string): Promise<Problem | null> {
    // æ£€æµ‹å¸¸è§é”™è¯¯æ¨¡å¼
    const patterns = {
      permission_denied: /permission denied/i,
      command_not_found: /command not found/i,
      disk_full: /no space left on device/i,
      connection_refused: /connection refused/i,
    };

    for (const [type, pattern] of Object.entries(patterns)) {
      if (pattern.test(output)) {
        return {
          type,
          command,
          output,
          suggestedSolution: await this.getSolution(type),
        };
      }
    }

    return null;
  }

  async getSolution(problemType: string): Promise<string> {
    // ä»çŸ¥è¯†åº“æŸ¥è¯¢æˆ–è°ƒç”¨ AI
    const entry = await this.repository.findByType(problemType);
    return entry?.solution || (await this.aiOpsService.generateSolution(problemType));
  }
}
```

#### å‰ç«¯é—®é¢˜é¢æ¿

```vue
<!-- ErrorAssistantPanel.vue -->
<template>
  <div v-if="detectedProblem" class="error-assistant">
    <div class="problem-card">
      <h4>âŒ æ£€æµ‹åˆ°é—®é¢˜ï¼š{{ detectedProblem.type }}</h4>
      <p>{{ detectedProblem.command }}</p>
      <div class="solution">
        <h5>ğŸ’¡ å»ºè®®è§£å†³æ–¹æ¡ˆï¼š</h5>
        <Markdown :content="detectedProblem.suggestedSolution" />
      </div>
      <button @click="saveToLibrary">ä¿å­˜åˆ°çŸ¥è¯†åº“</button>
    </div>
  </div>
</template>
```

**é¢„è®¡å·¥ä½œé‡**ï¼š5-7 å¤©

---

### 11.3 æœåŠ¡å™¨è¿ç»´æ‰‹å†Œ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- ä¸ºæ¯ä¸ªæœåŠ¡å™¨åˆ›å»ºè¿ç»´æ–‡æ¡£
- è®°å½•æœåŠ¡æ¶æ„ã€éƒ¨ç½²ä¿¡æ¯ã€å¸¸ç”¨æ“ä½œ
- è‡ªåŠ¨ç”ŸæˆæœåŠ¡å™¨æ‹“æ‰‘å›¾
- ç‰ˆæœ¬å†å²è®°å½•

**å®æ–½æ–¹æ¡ˆ**ï¼š

#### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE server_documentation (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  connection_id INTEGER NOT NULL,
  sections TEXT NOT NULL,        -- JSONï¼Œæ–‡æ¡£åˆ†èŠ‚
  topology_data TEXT,            -- JSONï¼Œæ‹“æ‰‘å›¾æ•°æ®
  version INTEGER DEFAULT 1,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (connection_id) REFERENCES connections(id)
);

CREATE TABLE documentation_versions (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  doc_id INTEGER NOT NULL,
  version INTEGER NOT NULL,
  content TEXT NOT NULL,
  changed_by TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (doc_id) REFERENCES server_documentation(id)
);
```

#### sections ç»“æ„

```json
{
  "basic_info": {
    "os": "Ubuntu 22.04",
    "role": "Web Server",
    "owner": "personal"
  },
  "architecture": {
    "services": ["nginx", "docker", "postgresql"],
    "ports": [80, 443, 5432]
  },
  "operations": {
    "deployment": "git pull && docker-compose up -d",
    "backup": "pg_dump database > backup.sql",
    "monitoring": "systemctl status nginx"
  },
  "notes": "Markdown content here..."
}
```

#### å‰ç«¯æ–‡æ¡£ç¼–è¾‘å™¨

```
documentation/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ DocEditor.vue          # å¤šèŠ‚ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ TopologyEditor.vue     # æ‹“æ‰‘å›¾ç¼–è¾‘å™¨ï¼ˆä½¿ç”¨ D3.js/Cytoscapeï¼‰
â”‚   â””â”€â”€ VersionHistory.vue     # ç‰ˆæœ¬å†å²æŸ¥çœ‹å™¨
```

**é¢„è®¡å·¥ä½œé‡**ï¼š6-8 å¤©

---

## é•¿æœŸæ„¿æ™¯åŠŸèƒ½

### L1: ç»ˆç«¯ AI Copilot â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å®æ—¶åˆ†æå‘½ä»¤æ„å›¾ï¼Œæä¾›ä¸‹ä¸€æ­¥å»ºè®®
- è‡ªç„¶è¯­è¨€è½¬å‘½ä»¤ï¼ˆ"åˆ—å‡ºæ‰€æœ‰å¤§äº 100MB çš„æ–‡ä»¶" â†’ `find . -size +100M`ï¼‰
- å‘½ä»¤è§£é‡Šå™¨ï¼ˆè§£é‡Šå¤æ‚å‘½ä»¤çš„å«ä¹‰ï¼‰
- é”™è¯¯è¯Šæ–­ä¸è‡ªåŠ¨ä¿®å¤

**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š

- é›†æˆæœ¬åœ° LLMï¼ˆllama.cpp + Mistral/Llama 3ï¼‰
- æˆ–è°ƒç”¨ OpenAI/Claude APIï¼ˆç”¨æˆ·é…ç½®ï¼‰
- ä½¿ç”¨ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ä»å†å²å‘½ä»¤å­¦ä¹ 

**é¢„è®¡å·¥ä½œé‡**ï¼š10-15 å¤©

---

### L2: è¿œç¨‹åä½œï¼ˆå±å¹•å…±äº«ï¼‰ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- ç”Ÿæˆä¸´æ—¶åˆ†äº«é“¾æ¥ï¼Œå…è®¸ä»–äººæŸ¥çœ‹ç»ˆç«¯ä¼šè¯
- åªè¯»æ¨¡å¼ï¼ˆä»–äººæ— æ³•è¾“å…¥ï¼‰
- å¯é€‰ï¼šåä½œæ¨¡å¼ï¼ˆå¤šäººåŒæ—¶æ“ä½œï¼‰

**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š

- WebRTC å®ç°å±å¹•å…±äº«
- åç«¯ç”Ÿæˆä¸€æ¬¡æ€§ Token
- å‰ç«¯ä½¿ç”¨ Canvas æ¸²æŸ“ç»ˆç«¯å†…å®¹å¹¶æµå¼ä¼ è¾“

**é¢„è®¡å·¥ä½œé‡**ï¼š8-10 å¤©

---

### L3: æ’ä»¶ç³»ç»Ÿ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- æ”¯æŒç”¨æˆ·ç¼–å†™è‡ªå®šä¹‰æ’ä»¶ï¼ˆJavaScript/TypeScriptï¼‰
- æ’ä»¶ Hook ç³»ç»Ÿï¼ˆå‘½ä»¤æ‰§è¡Œå‰åã€è¿æ¥å»ºç«‹ç­‰ï¼‰
- æ’ä»¶å¸‚åœºï¼ˆå†…ç½®å¸¸ç”¨æ’ä»¶ï¼‰

**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š

- æ’ä»¶æ²™ç®±ï¼ˆä½¿ç”¨ VM2 æˆ– Web Workerï¼‰
- æ’ä»¶ API è®¾è®¡ï¼ˆæš´éœ²å—é™çš„ç³»ç»Ÿæ¥å£ï¼‰
- æ’ä»¶é…ç½®ç•Œé¢

**é¢„è®¡å·¥ä½œé‡**ï¼š12-15 å¤©

---

### L4: æ€§èƒ½ç›‘æ§ä¸å‘Šè­¦ â­â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å®æ—¶ç›‘æ§æœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡
- è‡ªå®šä¹‰å‘Šè­¦è§„åˆ™ï¼ˆå¦‚ CPU > 80% æŒç»­ 5 åˆ†é’Ÿï¼‰
- å‘Šè­¦é€šçŸ¥ï¼ˆé‚®ä»¶ã€Telegramã€é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ï¼‰
- å†å²æ•°æ®å¯è§†åŒ–

**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š

- åç«¯å®šæ—¶é‡‡é›†æŒ‡æ ‡ï¼ˆInfluxDB æˆ– SQLite å­˜å‚¨æ—¶åºæ•°æ®ï¼‰
- å‘Šè­¦å¼•æ“ï¼ˆåŸºäºè§„åˆ™å¼•æ“ï¼‰
- å‰ç«¯ WebSocket å®æ—¶æ¨é€å‘Šè­¦

**é¢„è®¡å·¥ä½œé‡**ï¼š10-12 å¤©

---

### L5: å®¹å™¨ä¸ Kubernetes é›†æˆ â­â­

**åŠŸèƒ½æè¿°**ï¼š

- å¯è§†åŒ–ç®¡ç† Docker å®¹å™¨ï¼ˆå¯åŠ¨ã€åœæ­¢ã€æ—¥å¿—æŸ¥çœ‹ï¼‰
- Kubernetes é›†ç¾¤ç®¡ç†ï¼ˆPod åˆ—è¡¨ã€æ—¥å¿—ã€ç«¯å£è½¬å‘ï¼‰
- å®¹å™¨ç»ˆç«¯å¿«é€Ÿè¿›å…¥ï¼ˆ`docker exec`ï¼‰

**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š

- åç«¯é›†æˆ Dockerodeï¼ˆDocker API å®¢æˆ·ç«¯ï¼‰
- åç«¯é›†æˆ @kubernetes/client-node
- å‰ç«¯å®¹å™¨ç®¡ç†é¢æ¿

**é¢„è®¡å·¥ä½œé‡**ï¼š10-15 å¤©

---

## å®æ–½ä¼˜å…ˆçº§çŸ©é˜µ

| åŠŸèƒ½                     | ä¼˜å…ˆçº§    | å®æ–½éš¾åº¦ | ç”¨æˆ·ä»·å€¼ | é¢„è®¡å·¥ä½œé‡ | å»ºè®®å¼€å§‹æ—¶é—´ |
| ------------------------ | --------- | -------- | -------- | ---------- | ------------ |
| **å¿«é€Ÿå‘½ä»¤æ¨¡æ¿ç³»ç»Ÿ**     | P0 â­â­â­ | ä¸­       | æé«˜     | 5-7 å¤©     | ç«‹å³         |
| **å·¥ä½œåŒºå¿«ç…§ä¸åœºæ™¯åˆ‡æ¢** | P0 â­â­â­ | ä¸­       | æé«˜     | 4-6 å¤©     | ç«‹å³         |
| **æ™ºèƒ½å‘½ä»¤æ¨èç³»ç»Ÿ**     | P0 â­â­â­ | é«˜       | é«˜       | 6-8 å¤©     | Phase 7      |
| **ä¸ªäººè¿ç»´ä»ªè¡¨ç›˜**       | P0 â­â­â­ | ä¸­       | æé«˜     | 6-8 å¤©     | Phase 8      |
| **ç»ˆç«¯å½•åˆ¶ä¸å›æ”¾**       | P0 â­â­â­ | ä¸­       | é«˜       | 7-10 å¤©    | Phase 10     |
| **å†…ç½®æ–‡æ¡£ä¸ç¬”è®°ç³»ç»Ÿ**   | P0 â­â­â­ | ä¸­       | æé«˜     | 6-8 å¤©     | Phase 11     |
| **è‡ªåŠ¨åŒ–å·¡æ£€ä»»åŠ¡**       | P1 â­â­â­ | é«˜       | é«˜       | 7-10 å¤©    | Phase 7      |
| **ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–**       | P1 â­â­â­ | ä¸­       | é«˜       | 5-7 å¤©     | Phase 9      |
| **æ€§èƒ½ç›‘æ§ä¸å‘Šè­¦**       | P1 â­â­â­ | é«˜       | æé«˜     | 10-12 å¤©   | é•¿æœŸ         |
| **è¿æ¥åˆ†ç»„ä¸æ ‡ç­¾ç³»ç»Ÿ**   | P1 â­â­   | ä½       | ä¸­       | 2-3 å¤©     | Phase 6      |
| **å‘½ä»¤ä¹¦ç­¾ä¸æ”¶è—å¤¹**     | P1 â­â­   | ä½       | ä¸­       | 2-3 å¤©     | Phase 6      |
| **æ–‡ä»¶è‡ªåŠ¨å¤‡ä»½ä¸åŒæ­¥**   | P1 â­â­   | ä¸­       | é«˜       | 5-7 å¤©     | Phase 7      |
| **æ—¥å¿—èšåˆä¸æœç´¢**       | P1 â­â­   | é«˜       | ä¸­       | 6-8 å¤©     | Phase 8      |
| **å‘½ä»¤æ‰§è¡Œåˆ†ææŠ¥å‘Š**     | P1 â­â­   | ä¸­       | ä¸­       | 4-5 å¤©     | Phase 8      |
| **ç»ˆç«¯åˆ†å±ä¸å¸ƒå±€å¢å¼º**   | P1 â­â­   | ä¸­       | ä¸­       | 6-8 å¤©     | Phase 10     |
| **å‘½ä»¤è¾“å‡ºå¢å¼º**         | P1 â­â­   | ä¸­       | ä¸­       | 4-6 å¤©     | Phase 10     |
| **å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆåº“** | P1 â­â­   | ä¸­       | é«˜       | 5-7 å¤©     | Phase 11     |
| **æœåŠ¡å™¨è¿ç»´æ‰‹å†Œ**       | P1 â­â­   | ä¸­       | ä¸­       | 6-8 å¤©     | Phase 11     |
| **æµè§ˆå™¨æ‰©å±•ç‰ˆæœ¬**       | P2 â­â­   | ä¸­       | ä½       | 4-6 å¤©     | Phase 9      |
| **é…ç½®äº‘åŒæ­¥**           | P2 â­     | ä¸­       | ä½       | 6-8 å¤©     | Phase 9      |
| **ç»ˆç«¯ AI Copilot**      | P2 â­â­â­ | æé«˜     | æé«˜     | 10-15 å¤©   | é•¿æœŸ         |
| **å®¹å™¨ä¸ K8s é›†æˆ**      | P2 â­â­   | é«˜       | ä¸­       | 10-15 å¤©   | é•¿æœŸ         |
| **è¿œç¨‹åä½œï¼ˆå±å¹•å…±äº«ï¼‰** | P2 â­â­   | é«˜       | ä½       | 8-10 å¤©    | é•¿æœŸ         |
| **æ’ä»¶ç³»ç»Ÿ**             | P2 â­â­   | æé«˜     | ä¸­       | 12-15 å¤©   | é•¿æœŸ         |

**ä¼˜å…ˆçº§è¯´æ˜**ï¼š

- **P0**ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼Œåº”ä¼˜å…ˆå®æ–½
- **P1**ï¼šé‡è¦åŠŸèƒ½ï¼Œæå‡ä½¿ç”¨ä½“éªŒ
- **P2**ï¼šå¢å¼ºåŠŸèƒ½ï¼Œå¯åæœŸå®æ–½

---

## æŠ€æœ¯æ¶æ„æ¼”è¿›å»ºè®®

### 1. æ•°æ®åº“ä¼˜åŒ–

**å½“å‰é—®é¢˜**ï¼š

- SQLite å•æ–‡ä»¶æ•°æ®åº“ï¼Œæ•°æ®é‡å¢é•¿å¯èƒ½å½±å“æ€§èƒ½

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

- å¯ç”¨ WAL æ¨¡å¼ï¼ˆWrite-Ahead Loggingï¼‰æå‡å¹¶å‘æ€§èƒ½
  ```sql
  PRAGMA journal_mode=WAL;
  ```
- ä¸ºé«˜é¢‘æŸ¥è¯¢æ·»åŠ ç´¢å¼•ï¼ˆå·²éƒ¨åˆ†å®æ–½ï¼‰
- å®šæœŸ VACUUM æ¸…ç†ç¢ç‰‡
- è€ƒè™‘å°†æ—¶åºæ•°æ®ï¼ˆæŒ‡æ ‡ã€æ—¥å¿—ï¼‰å•ç‹¬å­˜å‚¨ï¼ˆSQLite æˆ– InfluxDBï¼‰

---

### 2. å‰ç«¯æ€§èƒ½ä¼˜åŒ–

**å½“å‰é—®é¢˜**ï¼š

- å¤šæ ‡ç­¾é¡µæ‰“å¼€æ—¶å†…å­˜å ç”¨è¾ƒé«˜
- å¤§é‡å†å²å‘½ä»¤æ¸²æŸ“å¯èƒ½å¡é¡¿

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

- å®æ–½è™šæ‹Ÿæ»šåŠ¨ï¼ˆ`vue-virtual-scroller`ï¼‰
- æ ‡ç­¾é¡µæ‡’åŠ è½½ï¼ˆéæ´»åŠ¨æ ‡ç­¾é¡µä¸æ¸²æŸ“ç»ˆç«¯ï¼‰
- ä½¿ç”¨ Web Worker å¤„ç†è€—æ—¶è®¡ç®—ï¼ˆå¦‚å‘½ä»¤åˆ†æï¼‰
- å¯ç”¨ Vite ä»£ç åˆ†å‰²ï¼ˆåŠ¨æ€ importï¼‰

---

### 3. WebSocket è¿æ¥ç®¡ç†

**å½“å‰é—®é¢˜**ï¼š

- å¤§é‡è¿æ¥æ—¶ WebSocket ç®¡ç†å¤æ‚

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

- å®æ–½è¿æ¥æ± ç®¡ç†
- å¿ƒè·³æœºåˆ¶ä¼˜åŒ–ï¼ˆå·²å®æ–½ï¼ŒæŒç»­ç›‘æ§ï¼‰
- æ”¯æŒæ–­çº¿é‡è¿ï¼ˆæŒ‡æ•°é€€é¿ç­–ç•¥ï¼‰

---

### 4. å®‰å…¨åŠ å›º

**å½“å‰é—®é¢˜**ï¼š

- æ•æ„Ÿæ•°æ®åŠ å¯†ï¼ˆå·²éƒ¨åˆ†å®æ–½ï¼‰
- XSS/CSRF é˜²æŠ¤éœ€æŒç»­å…³æ³¨

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

- å®šæœŸå®¡è®¡ä¾èµ–æ¼æ´ï¼ˆ`npm audit`ï¼‰
- å®æ–½ CSPï¼ˆContent Security Policyï¼‰
- æ•æ„Ÿæ“ä½œæ·»åŠ äºŒæ¬¡ç¡®è®¤ï¼ˆåˆ é™¤è¿æ¥ã€æ¸…ç©ºæ—¥å¿—ç­‰ï¼‰
- API è¯·æ±‚ç­¾åï¼ˆé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰

---

### 5. å¯è§‚æµ‹æ€§

**å½“å‰é—®é¢˜**ï¼š

- ç¼ºä¹ç³»ç»Ÿè¿è¡Œæ—¶ç›‘æ§
- é”™è¯¯æ—¥å¿—åˆ†æ•£

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

- é›†æˆåº”ç”¨æ€§èƒ½ç›‘æ§ï¼ˆAPMï¼‰ï¼šSentry / Datadog
- ç»“æ„åŒ–æ—¥å¿—ï¼ˆä½¿ç”¨ Winston æˆ– Pinoï¼‰
- æ·»åŠ å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼ˆ`/health`ï¼‰
- å‰ç«¯é”™è¯¯æ•è·ä¸ä¸ŠæŠ¥

---

### 6. æµ‹è¯•è¦†ç›–ç‡

**å½“å‰é—®é¢˜**ï¼š

- æ— è‡ªåŠ¨åŒ–æµ‹è¯•

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

- **Phase 1**ï¼šå…³é”®æ¨¡å—å•å…ƒæµ‹è¯•ï¼ˆè®¤è¯ã€å‘½ä»¤æ‰§è¡Œã€æ–‡ä»¶ä¸Šä¼ ï¼‰
- **Phase 2**ï¼šAPI é›†æˆæµ‹è¯•ï¼ˆSupertestï¼‰
- **Phase 3**ï¼šå‰ç«¯ç»„ä»¶æµ‹è¯•ï¼ˆVitest + Vue Test Utilsï¼‰
- **Phase 4**ï¼šE2E æµ‹è¯•ï¼ˆCypress / Playwrightï¼‰

---

## å®æ–½å»ºè®®

### çŸ­æœŸç›®æ ‡ï¼ˆ1-2 ä¸ªæœˆï¼‰

1. å®æ–½ **Phase 6**ï¼ˆä¸ªäººå·¥ä½œæµå¢å¼ºï¼‰
   - å¿«é€Ÿå‘½ä»¤æ¨¡æ¿ç³»ç»Ÿ
   - å·¥ä½œåŒºå¿«ç…§
   - è¿æ¥åˆ†ç»„ä¸æ ‡ç­¾
   - å‘½ä»¤ä¹¦ç­¾

2. å®Œå–„ç°æœ‰åŠŸèƒ½
   - ä¿®å¤å·²çŸ¥ Bug
   - ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒ
   - æ·»åŠ å•å…ƒæµ‹è¯•

### ä¸­æœŸç›®æ ‡ï¼ˆ3-6 ä¸ªæœˆï¼‰

1. å®æ–½ **Phase 7**ï¼ˆæ™ºèƒ½åŒ–ä¸è‡ªåŠ¨åŒ–ï¼‰
   - æ™ºèƒ½å‘½ä»¤æ¨è
   - è‡ªåŠ¨åŒ–å·¡æ£€ä»»åŠ¡

2. å®æ–½ **Phase 8**ï¼ˆæ•°æ®æ´å¯Ÿä¸å¯è§†åŒ–ï¼‰
   - ä¸ªäººè¿ç»´ä»ªè¡¨ç›˜
   - å‘½ä»¤æ‰§è¡Œåˆ†ææŠ¥å‘Š

3. å®æ–½ **Phase 10**ï¼ˆé«˜çº§ç»ˆç«¯èƒ½åŠ›ï¼‰
   - ç»ˆç«¯å½•åˆ¶ä¸å›æ”¾

### é•¿æœŸç›®æ ‡ï¼ˆ6-12 ä¸ªæœˆï¼‰

1. å®æ–½ **Phase 11**ï¼ˆä¸ªäººçŸ¥è¯†åº“ï¼‰
   - å†…ç½®æ–‡æ¡£ä¸ç¬”è®°ç³»ç»Ÿ
   - å¸¸è§é—®é¢˜åº“

2. æ¢ç´¢é•¿æœŸæ„¿æ™¯åŠŸèƒ½
   - ç»ˆç«¯ AI Copilot
   - æ€§èƒ½ç›‘æ§ä¸å‘Šè­¦
   - å®¹å™¨ä¸ K8s é›†æˆ

---

## ç»“è¯­

æœ¬è·¯çº¿å›¾åŸºäºå½“å‰é¡¹ç›®å®šä½ï¼ˆä¸ªäººä½¿ç”¨ï¼‰ï¼Œé¿å…äº†å¤šç”¨æˆ·æƒé™ç®¡ç†ç­‰å¤æ‚åŠŸèƒ½ï¼Œä¸“æ³¨äºæå‡ä¸ªäººè¿ç»´æ•ˆç‡ã€‚

**æ ¸å¿ƒç†å¿µ**ï¼š

- ğŸš€ **æ•ˆç‡ä¼˜å…ˆ**ï¼šå‡å°‘é‡å¤æ“ä½œï¼Œè‡ªåŠ¨åŒ–æµç¨‹
- ğŸ§  **æ™ºèƒ½åŒ–**ï¼šAI è¾…åŠ©è¿ç»´ï¼Œæ™ºèƒ½æ¨è
- ğŸ“Š **å¯è§†åŒ–**ï¼šæ•°æ®æ´å¯Ÿï¼Œè¶‹åŠ¿åˆ†æ
- ğŸ“š **çŸ¥è¯†æ²‰æ·€**ï¼šå†…ç½®ç¬”è®°ç³»ç»Ÿï¼Œé—®é¢˜è§£å†³æ–¹æ¡ˆåº“

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**ï¼š

1. ä¸é¡¹ç›®ç»´æŠ¤è€…è®¨è®ºä¼˜å…ˆçº§
2. åˆ›å»º GitHub Issues è·Ÿè¸ªå„ Phase ä»»åŠ¡
3. æŒ‰ Phase 6 å¼€å§‹å®æ–½
4. æ¯å®Œæˆä¸€ä¸ª Phase æ›´æ–°æœ¬æ–‡æ¡£

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¶é—´**ï¼š2025-12-22  
**æœ€åæ›´æ–°**ï¼š2025-12-22  
**ç»´æŠ¤è€…**ï¼šNexus Terminal Team
